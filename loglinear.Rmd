---
title: "loglinear"
author: "Dong Luo"
date: "22 October 2018"
output: pdf_document
---

# Data Cleaning

We exclude the obervations with age less than 18 since our research questions only focus on adult.

```{r import_data, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
setwd("~/GitHub/STAT3014-Major-Project")
#library(ggplot2)
Data <- read.csv("cleanedData.csv")
#dim(Data)
adultData<-Data[Data$AGEC>=18,]
```
We cut each of the continuous variables `CHOPER1`, `FATPER1`, and `PROPER1`, which stannd for the percentage of energy comes from carbohydrate, fat,and protein, into three distinct levels, from low, medium, to high.

|        | Carbohydrate | Fat      | Protein  |
|--------|--------------|----------|----------|
| low(%)    | [0,45]       | [0,20]   | [0,15]   |
| medium(%) | (45,65]      | (20,35]  | (15,25]  |
| high(%)   | (65,100]     | (35,100] | (25,100] |

```{r cut,echo=FALSE}
carb.cat<-cut(adultData$CHOPER1,
              breaks=c(-1,45,65,100),
              labels=c('low','medium','high'))
fat.cat<-cut(adultData$FATPER1,
             breaks=c(-1,20,35,100),
             labels=c('low','medium','high'))
protein.cat<-cut(adultData$PROPER1,
                 breaks=c(-1,15,25,100),
                 labels=c('low','medium','high'))
```

By dividing we are interested in the mean proportion of each diet types, so as to identify what are the most popular diet types.

```{r}
tables.3way<-table(carb.cat,fat.cat,protein.cat)
table.y<-NULL
for(i in 1:3){
  for(j in 1:3){
    table.y<-c(table.y,tables.3way[j,,i])
  }
}
table.fat<-factor(rep(c('low','medium','high'),9))
table.carb<-factor(rep(c('low','medium','high'),each=3,times=3))
table.protein<-factor(rep(c('low','medium','high'),each=9))
loglin.dat<-data.frame(y=table.y,
                          fat=table.fat,
                          carb=table.carb,
                          protein=table.protein)
diet.prop<-cbind(loglin.dat[,1]/nrow(adultData),
  loglin.dat[,2:4])
colnames(diet.prop)[1]<-'proportion'

# sort the df by proportion
diet.prop<-diet.prop[order(
  diet.prop$proportion,decreasing=TRUE),]

# see most common diet types in our sample
kable_styling(kable(
  head(diet.prop),
  row.names = F,
  format='latex',
  booktabs=TRUE),position = "center")
```



